# PROJECT_ID: the project ID of the build.
# $BUILD_ID: the autogenerated ID of the build.
# $REPO_NAME: the source repository name specified by RepoSource.
# $BRANCH_NAME: the branch name specified by RepoSource.
# $TAG_NAME: the tag name specified by RepoSource.
# $REVISION_ID or $COMMIT_SHA: the commit SHA specified by RepoSource or resolved from the specified branch or tag.
# $SHORT_SHA: first 7 characters of $REVISION_ID or $COMMIT_SHA.

steps:
#### Core
  - name: 'gcr.io/cloud-builders/gcloud'
    args: ['builds', 'submit', '--config', 'cloudbuild.yaml']
    dir: 'services/core/GcsFileInfo'
    waitFor: ['-']
  - name: 'gcr.io/cloud-builders/gcloud'
    args: ['builds', 'submit', '--config', 'cloudbuild.yaml']
    dir: 'services/core/MetaDataFileWriter'
    waitFor: ['-']

#### Images
  - name: 'gcr.io/cloud-builders/gcloud'
    args: ['builds', 'submit', '--config', 'cloudbuild.yaml']
    dir: 'services/images/ExifParser'
    waitFor: ['-']
  - name: 'gcr.io/cloud-builders/gcloud'
    args: ['builds', 'submit', '--config', 'cloudbuild.yaml']
    dir: 'services/images/VisionFacesApi'
    waitFor: ['-']
  - name: 'gcr.io/cloud-builders/gcloud'
    args: ['builds', 'submit', '--config', 'cloudbuild.yaml']
    dir: 'services/images/VisionLandmarkApi'
    waitFor: ['-']
  - name: 'gcr.io/cloud-builders/gcloud'
    args: ['builds', 'submit', '--config', 'cloudbuild.yaml']
    dir: 'services/images/VisionPropertiesApi'
    waitFor: ['-']


#options:
#  env: [string, string, ...]